797,1525,2025-06-22 20:48:35.6015924,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command 
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Registry, Started, \tProviderName=Registry\n\tNewProviderState=Started\n\n\tSequenceNumber=1\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=c052780f-7be8-4a65-85fb-971c35d9dfbd\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command \n $isBroken = 0\n\n # Define the root registry path\n $ShellRegRoot = 'HKCU:\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell'\n $bagMRURoot = $ShellRegRoot + '\\BagMRU'\n $bagRoot = $ShellRegRoot + '\\Bags'\n\n # Define the target GUID tail for MSGraphHome\n $HomeFolderGuid = '14001F400E3174F8B7B6DC47BC84B9E6B38F59030000'\n\n $properties = Get-ItemProperty -Path $bagMRURoot\n\n foreach ($property in $properties.PSObject.Properties) {\n if ($property.TypeNameOfValue -eq 'System.Byte[]') {\n $hexString = ($property.Value | ForEach-Object { $_.ToString('X2') }) -join ''\n if ($hexString -eq $HomeFolderGuid) {\n $subkey = $property.Name\n $nodeSlot = Get-ItemPropertyValue -Path ($bagMRURoot + '\\' + $subkey) -Name 'NodeSlot'\n $isBroken = if ((Get-ItemPropertyValue -Path ($bagRoot + '\\' + $nodeSlot + '\\Shell\\*') -Name 'GroupView') -eq 0) { 1 } else { 0 }\n break\n }\n }\n }\n\n Write-Host 'Final result:',$isBroken\n\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
798,1526,2025-06-22 20:48:35.6015924,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command 
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Alias, Started, \tProviderName=Alias\n\tNewProviderState=Started\n\n\tSequenceNumber=3\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=c052780f-7be8-4a65-85fb-971c35d9dfbd\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command \n $isBroken = 0\n\n # Define the root registry path\n $ShellRegRoot = 'HKCU:\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell'\n $bagMRURoot = $ShellRegRoot + '\\BagMRU'\n $bagRoot = $ShellRegRoot + '\\Bags'\n\n # Define the target GUID tail for MSGraphHome\n $HomeFolderGuid = '14001F400E3174F8B7B6DC47BC84B9E6B38F59030000'\n\n $properties = Get-ItemProperty -Path $bagMRURoot\n\n foreach ($property in $properties.PSObject.Properties) {\n if ($property.TypeNameOfValue -eq 'System.Byte[]') {\n $hexString = ($property.Value | ForEach-Object { $_.ToString('X2') }) -join ''\n if ($hexString -eq $HomeFolderGuid) {\n $subkey = $property.Name\n $nodeSlot = Get-ItemPropertyValue -Path ($bagMRURoot + '\\' + $subkey) -Name 'NodeSlot'\n $isBroken = if ((Get-ItemPropertyValue -Path ($bagRoot + '\\' + $nodeSlot + '\\Shell\\*') -Name 'GroupView') -eq 0) { 1 } else { 0 }\n break\n }\n }\n }\n\n Write-Host 'Final result:',$isBroken\n\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
799,1527,2025-06-22 20:48:35.6015924,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command 
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Environment, Started, \tProviderName=Environment\n\tNewProviderState=Started\n\n\tSequenceNumber=5\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=c052780f-7be8-4a65-85fb-971c35d9dfbd\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command \n $isBroken = 0\n\n # Define the root registry path\n $ShellRegRoot = 'HKCU:\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell'\n $bagMRURoot = $ShellRegRoot + '\\BagMRU'\n $bagRoot = $ShellRegRoot + '\\Bags'\n\n # Define the target GUID tail for MSGraphHome\n $HomeFolderGuid = '14001F400E3174F8B7B6DC47BC84B9E6B38F59030000'\n\n $properties = Get-ItemProperty -Path $bagMRURoot\n\n foreach ($property in $properties.PSObject.Properties) {\n if ($property.TypeNameOfValue -eq 'System.Byte[]') {\n $hexString = ($property.Value | ForEach-Object { $_.ToString('X2') }) -join ''\n if ($hexString -eq $HomeFolderGuid) {\n $subkey = $property.Name\n $nodeSlot = Get-ItemPropertyValue -Path ($bagMRURoot + '\\' + $subkey) -Name 'NodeSlot'\n $isBroken = if ((Get-ItemPropertyValue -Path ($bagRoot + '\\' + $nodeSlot + '\\Shell\\*') -Name 'GroupView') -eq 0) { 1 } else { 0 }\n break\n }\n }\n }\n\n Write-Host 'Final result:',$isBroken\n\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
800,1528,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Registry, Started, \tProviderName=Registry\n\tNewProviderState=Started\n\n\tSequenceNumber=1\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=dac3b934-5f06-4436-bb75-9eba2c1bec8f\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\\inf\\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\\[defaultinstall.nt(amd64|arm|arm64|x86)\\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
801,1529,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Alias, Started, \tProviderName=Alias\n\tNewProviderState=Started\n\n\tSequenceNumber=3\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=dac3b934-5f06-4436-bb75-9eba2c1bec8f\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\\inf\\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\\[defaultinstall.nt(amd64|arm|arm64|x86)\\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
802,1530,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command 
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""FileSystem, Started, \tProviderName=FileSystem\n\tNewProviderState=Started\n\n\tSequenceNumber=7\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=c052780f-7be8-4a65-85fb-971c35d9dfbd\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command \n $isBroken = 0\n\n # Define the root registry path\n $ShellRegRoot = 'HKCU:\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell'\n $bagMRURoot = $ShellRegRoot + '\\BagMRU'\n $bagRoot = $ShellRegRoot + '\\Bags'\n\n # Define the target GUID tail for MSGraphHome\n $HomeFolderGuid = '14001F400E3174F8B7B6DC47BC84B9E6B38F59030000'\n\n $properties = Get-ItemProperty -Path $bagMRURoot\n\n foreach ($property in $properties.PSObject.Properties) {\n if ($property.TypeNameOfValue -eq 'System.Byte[]') {\n $hexString = ($property.Value | ForEach-Object { $_.ToString('X2') }) -join ''\n if ($hexString -eq $HomeFolderGuid) {\n $subkey = $property.Name\n $nodeSlot = Get-ItemPropertyValue -Path ($bagMRURoot + '\\' + $subkey) -Name 'NodeSlot'\n $isBroken = if ((Get-ItemPropertyValue -Path ($bagRoot + '\\' + $nodeSlot + '\\Shell\\*') -Name 'GroupView') -eq 0) { 1 } else { 0 }\n break\n }\n }\n }\n\n Write-Host 'Final result:',$isBroken\n\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
803,1531,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Registry, Started, \tProviderName=Registry\n\tNewProviderState=Started\n\n\tSequenceNumber=1\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=59c937c6-ebfd-4045-9ebf-9c91f8ba8565\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
804,1532,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Alias, Started, \tProviderName=Alias\n\tNewProviderState=Started\n\n\tSequenceNumber=3\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=59c937c6-ebfd-4045-9ebf-9c91f8ba8565\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
805,1533,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Environment, Started, \tProviderName=Environment\n\tNewProviderState=Started\n\n\tSequenceNumber=5\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=dac3b934-5f06-4436-bb75-9eba2c1bec8f\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\\inf\\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\\[defaultinstall.nt(amd64|arm|arm64|x86)\\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
806,1534,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Environment, Started, \tProviderName=Environment\n\tNewProviderState=Started\n\n\tSequenceNumber=5\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=59c937c6-ebfd-4045-9ebf-9c91f8ba8565\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
807,1535,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command 
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Function, Started, \tProviderName=Function\n\tNewProviderState=Started\n\n\tSequenceNumber=9\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=c052780f-7be8-4a65-85fb-971c35d9dfbd\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command \n $isBroken = 0\n\n # Define the root registry path\n $ShellRegRoot = 'HKCU:\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell'\n $bagMRURoot = $ShellRegRoot + '\\BagMRU'\n $bagRoot = $ShellRegRoot + '\\Bags'\n\n # Define the target GUID tail for MSGraphHome\n $HomeFolderGuid = '14001F400E3174F8B7B6DC47BC84B9E6B38F59030000'\n\n $properties = Get-ItemProperty -Path $bagMRURoot\n\n foreach ($property in $properties.PSObject.Properties) {\n if ($property.TypeNameOfValue -eq 'System.Byte[]') {\n $hexString = ($property.Value | ForEach-Object { $_.ToString('X2') }) -join ''\n if ($hexString -eq $HomeFolderGuid) {\n $subkey = $property.Name\n $nodeSlot = Get-ItemPropertyValue -Path ($bagMRURoot + '\\' + $subkey) -Name 'NodeSlot'\n $isBroken = if ((Get-ItemPropertyValue -Path ($bagRoot + '\\' + $nodeSlot + '\\Shell\\*') -Name 'GroupView') -eq 0) { 1 } else { 0 }\n break\n }\n }\n }\n\n Write-Host 'Final result:',$isBroken\n\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
808,1536,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""FileSystem, Started, \tProviderName=FileSystem\n\tNewProviderState=Started\n\n\tSequenceNumber=7\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=dac3b934-5f06-4436-bb75-9eba2c1bec8f\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\\inf\\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\\[defaultinstall.nt(amd64|arm|arm64|x86)\\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
809,1537,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""FileSystem, Started, \tProviderName=FileSystem\n\tNewProviderState=Started\n\n\tSequenceNumber=7\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=59c937c6-ebfd-4045-9ebf-9c91f8ba8565\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
810,1538,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Function, Started, \tProviderName=Function\n\tNewProviderState=Started\n\n\tSequenceNumber=9\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=dac3b934-5f06-4436-bb75-9eba2c1bec8f\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\\inf\\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\\[defaultinstall.nt(amd64|arm|arm64|x86)\\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
811,1539,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Function, Started, \tProviderName=Function\n\tNewProviderState=Started\n\n\tSequenceNumber=9\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=59c937c6-ebfd-4045-9ebf-9c91f8ba8565\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
812,1540,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command 
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Variable, Started, \tProviderName=Variable\n\tNewProviderState=Started\n\n\tSequenceNumber=11\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=c052780f-7be8-4a65-85fb-971c35d9dfbd\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command \n $isBroken = 0\n\n # Define the root registry path\n $ShellRegRoot = 'HKCU:\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell'\n $bagMRURoot = $ShellRegRoot + '\\BagMRU'\n $bagRoot = $ShellRegRoot + '\\Bags'\n\n # Define the target GUID tail for MSGraphHome\n $HomeFolderGuid = '14001F400E3174F8B7B6DC47BC84B9E6B38F59030000'\n\n $properties = Get-ItemProperty -Path $bagMRURoot\n\n foreach ($property in $properties.PSObject.Properties) {\n if ($property.TypeNameOfValue -eq 'System.Byte[]') {\n $hexString = ($property.Value | ForEach-Object { $_.ToString('X2') }) -join ''\n if ($hexString -eq $HomeFolderGuid) {\n $subkey = $property.Name\n $nodeSlot = Get-ItemPropertyValue -Path ($bagMRURoot + '\\' + $subkey) -Name 'NodeSlot'\n $isBroken = if ((Get-ItemPropertyValue -Path ($bagRoot + '\\' + $nodeSlot + '\\Shell\\*') -Name 'GroupView') -eq 0) { 1 } else { 0 }\n break\n }\n }\n }\n\n Write-Host 'Final result:',$isBroken\n\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
813,1541,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Variable, Started, \tProviderName=Variable\n\tNewProviderState=Started\n\n\tSequenceNumber=11\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=dac3b934-5f06-4436-bb75-9eba2c1bec8f\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\\inf\\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\\[defaultinstall.nt(amd64|arm|arm64|x86)\\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
814,1542,2025-06-22 20:48:35.6120973,600,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Provider is Started,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Variable, Started, \tProviderName=Variable\n\tNewProviderState=Started\n\n\tSequenceNumber=11\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=59c937c6-ebfd-4045-9ebf-9c91f8ba8565\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
815,1543,2025-06-22 20:48:35.6582692,400,Info,PowerShell,Windows PowerShell,0,0,Server002,17,,Engine state is changed from None to Available,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Available, None, \tNewEngineState=Available\n\tPreviousEngineState=None\n\n\tSequenceNumber=13\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=59c937c6-ebfd-4045-9ebf-9c91f8ba8565\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\n\tEngineVersion=5.1.19041.5737\n\tRunspaceId=e9ab4ab5-546f-436d-92e0-74c7b5d9aeef\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
816,1544,2025-06-22 20:48:35.6582692,400,Info,PowerShell,Windows PowerShell,0,0,Server002,18,,Engine state is changed from None to Available,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
",,,,,False,D:\benign_log_combined_latest_used_actually\new_benign\powershell_820.evtx,0x80000000000000,0,"{""EventData"":{""Data"":""Available, None, \tNewEngineState=Available\n\tPreviousEngineState=None\n\n\tSequenceNumber=13\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.5737\n\tHostId=dac3b934-5f06-4436-bb75-9eba2c1bec8f\n\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\\inf\\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\\[defaultinstall.nt(amd64|arm|arm64|x86)\\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\n\tEngineVersion=5.1.19041.5737\n\tRunspaceId=980d189f-5ea3-483c-bb1f-a521b4a7b48e\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="",""Binary"":""""}}"
817,1545,2025-06-22 20:48:35.6700659,400,Info,PowerShell,Windows PowerShell,0,0,Server002,18,,Engine state is changed from None to Available,,,"HostApplication=powershell.exe -ExecutionPolicy Restricted -Command 
","HostName=ConsoleHost
","HostVersion=5.1.19041.5737
