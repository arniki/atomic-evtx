{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 15:41:47.4915341"},"EventRecordID":"1058","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=2dd51ec5-c003-46f6-9080-8aa12084afcf\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 15:41:47.4942556"},"EventRecordID":"1059","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=0f7283a2-657c-4885-942b-0c22dbc562de\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 15:41:47.5020598"},"EventRecordID":"1060","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=58f5d768-b9aa-4139-95ae-13c1ce7972d4\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5007\tRunspaceId=a9f99f70-309e-4e16-b706-6a7c68c9dfd0\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 15:41:47.5020598"},"EventRecordID":"1061","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=0f7283a2-657c-4885-942b-0c22dbc562de\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 15:41:47.5135505"},"EventRecordID":"1062","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=0f7283a2-657c-4885-942b-0c22dbc562de\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=5.1.19041.5007\tRunspaceId=1f5b9de4-409d-4912-a01f-4f17dbd81a7f\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 15:41:47.8489641"},"EventRecordID":"1063","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=2dd51ec5-c003-46f6-9080-8aa12084afcf\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=5.1.19041.5007\tRunspaceId=1daedb44-18bc-488d-a977-c75754875a9f\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 15:42:29.1180793"},"EventRecordID":"1064","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=0f7283a2-657c-4885-942b-0c22dbc562de\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=5.1.19041.5007\tRunspaceId=1f5b9de4-409d-4912-a01f-4f17dbd81a7f\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 15:43:49.4383420"},"EventRecordID":"1065","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=58f5d768-b9aa-4139-95ae-13c1ce7972d4\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5007\tRunspaceId=a9f99f70-309e-4e16-b706-6a7c68c9dfd0\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 15:43:49.4827821"},"EventRecordID":"1066","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=71190939-e7e0-4c68-b7b3-87eb740e651d\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5007\tRunspaceId=8120aef8-8e80-4dec-8db1-21a11cb6a652\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 15:44:02.6819900"},"EventRecordID":"1067","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=2dd51ec5-c003-46f6-9080-8aa12084afcf\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=5.1.19041.5007\tRunspaceId=1daedb44-18bc-488d-a977-c75754875a9f\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 16:01:40.9716886"},"EventRecordID":"1068","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=64ce3030-3885-4524-a7c6-af151c7252fd\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 16:01:40.9934354"},"EventRecordID":"1069","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=64ce3030-3885-4524-a7c6-af151c7252fd\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 16:01:40.9981701"},"EventRecordID":"1070","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=64ce3030-3885-4524-a7c6-af151c7252fd\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 16:01:41.0169808"},"EventRecordID":"1071","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=64ce3030-3885-4524-a7c6-af151c7252fd\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 16:01:41.0186034"},"EventRecordID":"1072","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=64ce3030-3885-4524-a7c6-af151c7252fd\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 16:01:41.0186034"},"EventRecordID":"1073","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=64ce3030-3885-4524-a7c6-af151c7252fd\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 16:01:42.6151239"},"EventRecordID":"1074","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5007\tHostId=64ce3030-3885-4524-a7c6-af151c7252fd\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=5.1.19041.5007\tRunspaceId=fd9a2e11-05bd-43ed-9842-3c73bb0ef660\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 19:51:48.8052438"},"EventRecordID":"1075","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=811cc31a-0165-4002-b704-8ad201945ba2\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 19:51:48.8186781"},"EventRecordID":"1076","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=811cc31a-0165-4002-b704-8ad201945ba2\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 19:51:48.8255260"},"EventRecordID":"1077","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=811cc31a-0165-4002-b704-8ad201945ba2\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 19:51:48.8490198"},"EventRecordID":"1078","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=811cc31a-0165-4002-b704-8ad201945ba2\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 19:51:48.8490198"},"EventRecordID":"1079","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=811cc31a-0165-4002-b704-8ad201945ba2\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 19:51:48.8490198"},"EventRecordID":"1080","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=811cc31a-0165-4002-b704-8ad201945ba2\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-16 19:51:49.2559636"},"EventRecordID":"1081","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=811cc31a-0165-4002-b704-8ad201945ba2\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=5.1.19041.5737\tRunspaceId=e28fd26a-7341-43b7-a07d-3835478bf645\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:43.0219423"},"EventRecordID":"1082","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a6c8544a-d768-4b53-95c9-7ee88981d34a\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:43.0219423"},"EventRecordID":"1083","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a6c8544a-d768-4b53-95c9-7ee88981d34a\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:43.0411622"},"EventRecordID":"1084","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a6c8544a-d768-4b53-95c9-7ee88981d34a\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:43.0997273"},"EventRecordID":"1085","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a6c8544a-d768-4b53-95c9-7ee88981d34a\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:43.0997273"},"EventRecordID":"1086","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a6c8544a-d768-4b53-95c9-7ee88981d34a\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:43.0997273"},"EventRecordID":"1087","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a6c8544a-d768-4b53-95c9-7ee88981d34a\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:44.6036241"},"EventRecordID":"1088","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a6c8544a-d768-4b53-95c9-7ee88981d34a\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5737\tRunspaceId=06a6a1ec-5cd0-456e-a96f-347107ff7b08\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:48.8383026"},"EventRecordID":"1089","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bd5cb938-ef86-4402-8f71-eed137ccd221\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:48.8383026"},"EventRecordID":"1090","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bd5cb938-ef86-4402-8f71-eed137ccd221\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:48.8383026"},"EventRecordID":"1091","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bd5cb938-ef86-4402-8f71-eed137ccd221\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:48.8655950"},"EventRecordID":"1092","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bd5cb938-ef86-4402-8f71-eed137ccd221\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:48.8655950"},"EventRecordID":"1093","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bd5cb938-ef86-4402-8f71-eed137ccd221\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:48.8655950"},"EventRecordID":"1094","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bd5cb938-ef86-4402-8f71-eed137ccd221\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:43:49.5372445"},"EventRecordID":"1095","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bd5cb938-ef86-4402-8f71-eed137ccd221\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5737\tRunspaceId=d53adfae-7641-4bdb-9ec2-58221c18a6e7\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:46.1479122"},"EventRecordID":"1096","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d62b6e51-65ab-4c87-8f44-00e607db83c3\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:46.1726574"},"EventRecordID":"1097","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d62b6e51-65ab-4c87-8f44-00e607db83c3\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:46.1726574"},"EventRecordID":"1098","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d62b6e51-65ab-4c87-8f44-00e607db83c3\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:46.3224362"},"EventRecordID":"1099","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d62b6e51-65ab-4c87-8f44-00e607db83c3\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:46.3224362"},"EventRecordID":"1100","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d62b6e51-65ab-4c87-8f44-00e607db83c3\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:46.3224362"},"EventRecordID":"1101","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d62b6e51-65ab-4c87-8f44-00e607db83c3\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:46.6391276"},"EventRecordID":"1102","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a6c8544a-d768-4b53-95c9-7ee88981d34a\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5737\tRunspaceId=06a6a1ec-5cd0-456e-a96f-347107ff7b08\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:47.2239634"},"EventRecordID":"1103","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d62b6e51-65ab-4c87-8f44-00e607db83c3\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=5.1.19041.5737\tRunspaceId=c44880d2-83fe-4d6b-a4d5-a6b969946190\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:47.9124154"},"EventRecordID":"1104","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bd5cb938-ef86-4402-8f71-eed137ccd221\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5737\tRunspaceId=d53adfae-7641-4bdb-9ec2-58221c18a6e7\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:49.1531723"},"EventRecordID":"1105","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=81d518de-3a25-4118-b1ee-2062d7ee160f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:49.1531723"},"EventRecordID":"1106","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=81d518de-3a25-4118-b1ee-2062d7ee160f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:49.1531723"},"EventRecordID":"1107","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=81d518de-3a25-4118-b1ee-2062d7ee160f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:49.1531723"},"EventRecordID":"1108","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=81d518de-3a25-4118-b1ee-2062d7ee160f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:49.1531723"},"EventRecordID":"1109","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=81d518de-3a25-4118-b1ee-2062d7ee160f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:49.1531723"},"EventRecordID":"1110","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=81d518de-3a25-4118-b1ee-2062d7ee160f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:49.8207716"},"EventRecordID":"1111","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=81d518de-3a25-4118-b1ee-2062d7ee160f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=5.1.19041.5737\tRunspaceId=fbecae07-a56d-4ec1-9a3f-77d90f24882f\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:44:50.7747154"},"EventRecordID":"1112","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d62b6e51-65ab-4c87-8f44-00e607db83c3\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=5.1.19041.5737\tRunspaceId=c44880d2-83fe-4d6b-a4d5-a6b969946190\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 06:45:38.1635276"},"EventRecordID":"1113","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=81d518de-3a25-4118-b1ee-2062d7ee160f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=5.1.19041.5737\tRunspaceId=fbecae07-a56d-4ec1-9a3f-77d90f24882f\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 13:06:49.2063401"},"EventRecordID":"1114","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a240891f-46a0-4391-909b-1688329196e1\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 13:06:49.2108133"},"EventRecordID":"1115","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a240891f-46a0-4391-909b-1688329196e1\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 13:06:49.2200889"},"EventRecordID":"1116","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a240891f-46a0-4391-909b-1688329196e1\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 13:06:49.2659110"},"EventRecordID":"1117","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a240891f-46a0-4391-909b-1688329196e1\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 13:06:49.3227667"},"EventRecordID":"1118","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a240891f-46a0-4391-909b-1688329196e1\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 13:06:49.3297124"},"EventRecordID":"1119","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a240891f-46a0-4391-909b-1688329196e1\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 13:06:50.5242444"},"EventRecordID":"1120","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a240891f-46a0-4391-909b-1688329196e1\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=5.1.19041.5737\tRunspaceId=50cdb38b-d955-4025-a146-3c73cd87d5b6\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 15:05:51.9176301"},"EventRecordID":"1121","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0ecccf31-bf56-4f3e-9505-5ebb3d59fc40\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 15:05:51.9408659"},"EventRecordID":"1122","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0ecccf31-bf56-4f3e-9505-5ebb3d59fc40\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 15:05:51.9408659"},"EventRecordID":"1123","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0ecccf31-bf56-4f3e-9505-5ebb3d59fc40\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 15:05:51.9647232"},"EventRecordID":"1124","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0ecccf31-bf56-4f3e-9505-5ebb3d59fc40\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 15:05:51.9647232"},"EventRecordID":"1125","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0ecccf31-bf56-4f3e-9505-5ebb3d59fc40\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 15:05:51.9847440"},"EventRecordID":"1126","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0ecccf31-bf56-4f3e-9505-5ebb3d59fc40\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-17 15:05:52.8368631"},"EventRecordID":"1127","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0ecccf31-bf56-4f3e-9505-5ebb3d59fc40\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=5.1.19041.5737\tRunspaceId=b9695e5f-82a6-4fab-9db9-95f4cb291f0e\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:43.0399989"},"EventRecordID":"1128","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=5ab7df0a-08e1-43e2-af03-772ecc0caf97\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:43.0576830"},"EventRecordID":"1129","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=5ab7df0a-08e1-43e2-af03-772ecc0caf97\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:43.1201408"},"EventRecordID":"1130","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=5ab7df0a-08e1-43e2-af03-772ecc0caf97\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:43.1397682"},"EventRecordID":"1131","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=5ab7df0a-08e1-43e2-af03-772ecc0caf97\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:43.1397682"},"EventRecordID":"1132","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=5ab7df0a-08e1-43e2-af03-772ecc0caf97\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:43.1397682"},"EventRecordID":"1133","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=5ab7df0a-08e1-43e2-af03-772ecc0caf97\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:43.1709040"},"EventRecordID":"1134","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=5ab7df0a-08e1-43e2-af03-772ecc0caf97\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5737\tRunspaceId=63b621ec-3170-4419-98bf-75255c38b7b8\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:45.1195067"},"EventRecordID":"1135","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=1b7f159c-b25b-47ae-a67d-3755952b6eb7\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:45.1195067"},"EventRecordID":"1136","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=1b7f159c-b25b-47ae-a67d-3755952b6eb7\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:45.1195067"},"EventRecordID":"1137","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=1b7f159c-b25b-47ae-a67d-3755952b6eb7\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:45.1195067"},"EventRecordID":"1138","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=1b7f159c-b25b-47ae-a67d-3755952b6eb7\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:45.1195067"},"EventRecordID":"1139","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=1b7f159c-b25b-47ae-a67d-3755952b6eb7\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:45.1195067"},"EventRecordID":"1140","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=1b7f159c-b25b-47ae-a67d-3755952b6eb7\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
