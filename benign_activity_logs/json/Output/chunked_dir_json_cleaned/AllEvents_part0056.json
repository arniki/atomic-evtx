{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:45.1777850"},"EventRecordID":"1141","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=1b7f159c-b25b-47ae-a67d-3755952b6eb7\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5737\tRunspaceId=750bf0c7-16f3-4759-9360-c19a675a2484\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:52.3733665"},"EventRecordID":"1142","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=1b7f159c-b25b-47ae-a67d-3755952b6eb7\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5737\tRunspaceId=750bf0c7-16f3-4759-9360-c19a675a2484\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:53.1828626"},"EventRecordID":"1143","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=5ab7df0a-08e1-43e2-af03-772ecc0caf97\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5737\tRunspaceId=63b621ec-3170-4419-98bf-75255c38b7b8\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:53.9981380"},"EventRecordID":"1144","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=3d399251-ad10-429c-9b6a-c167b462075f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:54.0001547"},"EventRecordID":"1145","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=3d399251-ad10-429c-9b6a-c167b462075f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:54.0001547"},"EventRecordID":"1146","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=3d399251-ad10-429c-9b6a-c167b462075f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:54.0032006"},"EventRecordID":"1147","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=3d399251-ad10-429c-9b6a-c167b462075f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:54.0032006"},"EventRecordID":"1148","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=3d399251-ad10-429c-9b6a-c167b462075f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:54.0032006"},"EventRecordID":"1149","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=3d399251-ad10-429c-9b6a-c167b462075f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:54.0109171"},"EventRecordID":"1150","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=3d399251-ad10-429c-9b6a-c167b462075f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=5.1.19041.5737\tRunspaceId=8c03e238-ef17-4968-b9a3-916febe8122e\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:54.4302691"},"EventRecordID":"1151","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=3d399251-ad10-429c-9b6a-c167b462075f\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=5.1.19041.5737\tRunspaceId=8c03e238-ef17-4968-b9a3-916febe8122e\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:55.7236923"},"EventRecordID":"1152","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=4e467e72-4fec-4f4b-a6b2-0bb2387b2ce8\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:55.7236923"},"EventRecordID":"1153","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=4e467e72-4fec-4f4b-a6b2-0bb2387b2ce8\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:55.7236923"},"EventRecordID":"1154","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=4e467e72-4fec-4f4b-a6b2-0bb2387b2ce8\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:55.7236923"},"EventRecordID":"1155","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=4e467e72-4fec-4f4b-a6b2-0bb2387b2ce8\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:55.7236923"},"EventRecordID":"1156","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=4e467e72-4fec-4f4b-a6b2-0bb2387b2ce8\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:55.7236923"},"EventRecordID":"1157","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=4e467e72-4fec-4f4b-a6b2-0bb2387b2ce8\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:42:55.7756252"},"EventRecordID":"1158","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=4e467e72-4fec-4f4b-a6b2-0bb2387b2ce8\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=5.1.19041.5737\tRunspaceId=73299f59-7625-476d-9cec-d481a2478b8f\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 09:43:11.7118144"},"EventRecordID":"1159","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=4e467e72-4fec-4f4b-a6b2-0bb2387b2ce8\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=5.1.19041.5737\tRunspaceId=73299f59-7625-476d-9cec-d481a2478b8f\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 14:51:00.6885770"},"EventRecordID":"1160","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bfb21934-b0ab-47c7-9121-2b91e82ee7e4\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 14:51:00.6885770"},"EventRecordID":"1161","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bfb21934-b0ab-47c7-9121-2b91e82ee7e4\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 14:51:00.6885770"},"EventRecordID":"1162","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bfb21934-b0ab-47c7-9121-2b91e82ee7e4\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 14:51:00.6885770"},"EventRecordID":"1163","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bfb21934-b0ab-47c7-9121-2b91e82ee7e4\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 14:51:00.6885770"},"EventRecordID":"1164","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bfb21934-b0ab-47c7-9121-2b91e82ee7e4\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 14:51:00.6885770"},"EventRecordID":"1165","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bfb21934-b0ab-47c7-9121-2b91e82ee7e4\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-18 14:51:00.6885770"},"EventRecordID":"1166","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=bfb21934-b0ab-47c7-9121-2b91e82ee7e4\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=5.1.19041.5737\tRunspaceId=f54fd168-f9ea-485b-8ceb-f3f1632c77bb\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:34.0956807"},"EventRecordID":"1167","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=8f870414-5c43-4428-89e8-8f3e8933cd29\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:34.1044819"},"EventRecordID":"1168","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=87f6ff44-236c-4a57-baa7-db8cadaa0330\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:34.1044819"},"EventRecordID":"1169","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0efd739a-c241-4855-b025-3558a564a996\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:34.1201014"},"EventRecordID":"1170","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=87f6ff44-236c-4a57-baa7-db8cadaa0330\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:34.1201014"},"EventRecordID":"1171","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=8f870414-5c43-4428-89e8-8f3e8933cd29\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:34.1201014"},"EventRecordID":"1172","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=8f870414-5c43-4428-89e8-8f3e8933cd29\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:34.1201014"},"EventRecordID":"1173","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0efd739a-c241-4855-b025-3558a564a996\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:34.1201014"},"EventRecordID":"1174","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0efd739a-c241-4855-b025-3558a564a996\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:34.1201014"},"EventRecordID":"1175","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=87f6ff44-236c-4a57-baa7-db8cadaa0330\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:36.6746947"},"EventRecordID":"1176","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=8f870414-5c43-4428-89e8-8f3e8933cd29\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:36.6769978"},"EventRecordID":"1177","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=8f870414-5c43-4428-89e8-8f3e8933cd29\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:36.6781395"},"EventRecordID":"1178","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=8f870414-5c43-4428-89e8-8f3e8933cd29\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:37.0271941"},"EventRecordID":"1179","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=87f6ff44-236c-4a57-baa7-db8cadaa0330\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:37.0271941"},"EventRecordID":"1180","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=87f6ff44-236c-4a57-baa7-db8cadaa0330\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:37.0271941"},"EventRecordID":"1181","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=87f6ff44-236c-4a57-baa7-db8cadaa0330\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:37.0271941"},"EventRecordID":"1182","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0efd739a-c241-4855-b025-3558a564a996\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:37.0271941"},"EventRecordID":"1183","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0efd739a-c241-4855-b025-3558a564a996\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:37.0271941"},"EventRecordID":"1184","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0efd739a-c241-4855-b025-3558a564a996\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:39.0797699"},"EventRecordID":"1185","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=8f870414-5c43-4428-89e8-8f3e8933cd29\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=5.1.19041.5737\tRunspaceId=775b7c02-195a-4db0-a79f-c93bcad57ea5\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:39.1932231"},"EventRecordID":"1186","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=87f6ff44-236c-4a57-baa7-db8cadaa0330\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5737\tRunspaceId=17215dff-6803-483c-af2d-d893d4f46993\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:39.4401506"},"EventRecordID":"1187","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0efd739a-c241-4855-b025-3558a564a996\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5737\tRunspaceId=6a903735-497e-4e23-b685-c79e8909ffd5\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:44.3827399"},"EventRecordID":"1188","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a742ffd1-ae97-48ab-9eaa-667a064496b6\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:44.3827399"},"EventRecordID":"1189","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a742ffd1-ae97-48ab-9eaa-667a064496b6\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:44.3827399"},"EventRecordID":"1190","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a742ffd1-ae97-48ab-9eaa-667a064496b6\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:44.3827399"},"EventRecordID":"1191","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a742ffd1-ae97-48ab-9eaa-667a064496b6\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:44.3827399"},"EventRecordID":"1192","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a742ffd1-ae97-48ab-9eaa-667a064496b6\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:44.3827399"},"EventRecordID":"1193","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a742ffd1-ae97-48ab-9eaa-667a064496b6\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:13:44.6560894"},"EventRecordID":"1194","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a742ffd1-ae97-48ab-9eaa-667a064496b6\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=5.1.19041.5737\tRunspaceId=b08e6aa1-0820-45e2-9ece-d129a3fcbfab\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:14:27.1109972"},"EventRecordID":"1195","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=8f870414-5c43-4428-89e8-8f3e8933cd29\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';\tEngineVersion=5.1.19041.5737\tRunspaceId=775b7c02-195a-4db0-a79f-c93bcad57ea5\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:14:57.0425359"},"EventRecordID":"1196","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=0efd739a-c241-4855-b025-3558a564a996\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5737\tRunspaceId=6a903735-497e-4e23-b685-c79e8909ffd5\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:14:57.0968971"},"EventRecordID":"1197","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=87f6ff44-236c-4a57-baa7-db8cadaa0330\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=5.1.19041.5737\tRunspaceId=17215dff-6803-483c-af2d-d893d4f46993\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 08:15:51.6588327"},"EventRecordID":"1198","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\tPreviousEngineState=Available\tSequenceNumber=15\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=a742ffd1-ae97-48ab-9eaa-667a064496b6\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command $Res = 0; $Infs = Get-Item -Path ($env:WinDir + '\inf\*.inf'); foreach ($Inf in $Infs) { $Data = Get-Content $Inf.FullName; if ($Data -match '\[defaultinstall.nt(amd64|arm|arm64|x86)\]') { $Res = 1; break; } } Write-Host 'Final result:', $Res;\tEngineVersion=5.1.19041.5737\tRunspaceId=b08e6aa1-0820-45e2-9ece-d129a3fcbfab\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 09:07:44.3820118"},"EventRecordID":"1199","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=377f6591-fddd-47d7-a180-69e192fa22a5\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 09:07:44.3889536"},"EventRecordID":"1200","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=377f6591-fddd-47d7-a180-69e192fa22a5\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 09:07:44.3907550"},"EventRecordID":"1201","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=377f6591-fddd-47d7-a180-69e192fa22a5\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 09:07:44.4002586"},"EventRecordID":"1202","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=377f6591-fddd-47d7-a180-69e192fa22a5\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 09:07:44.4002586"},"EventRecordID":"1203","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=377f6591-fddd-47d7-a180-69e192fa22a5\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 09:07:44.4002586"},"EventRecordID":"1204","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=377f6591-fddd-47d7-a180-69e192fa22a5\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 09:07:44.4487044"},"EventRecordID":"1205","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=377f6591-fddd-47d7-a180-69e192fa22a5\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=5.1.19041.5737\tRunspaceId=56f7f997-bd01-4223-8a3a-3f0aee3ffde6\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 12:33:42.2762553"},"EventRecordID":"1206","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d892f233-7e11-48ab-bdfc-4da823de24de\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 12:33:42.2762553"},"EventRecordID":"1207","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d892f233-7e11-48ab-bdfc-4da823de24de\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 12:33:42.2917231"},"EventRecordID":"1208","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d892f233-7e11-48ab-bdfc-4da823de24de\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 12:33:42.3096400"},"EventRecordID":"1209","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d892f233-7e11-48ab-bdfc-4da823de24de\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 12:33:42.3126153"},"EventRecordID":"1210","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d892f233-7e11-48ab-bdfc-4da823de24de\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 12:33:42.3150330"},"EventRecordID":"1211","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d892f233-7e11-48ab-bdfc-4da823de24de\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-21 12:33:42.3399628"},"EventRecordID":"1212","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\tPreviousEngineState=None\tSequenceNumber=13\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=d892f233-7e11-48ab-bdfc-4da823de24de\tHostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\tEngineVersion=5.1.19041.5737\tRunspaceId=61d39ae6-5062-43a4-b65c-1f511d7d3f23\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-22 13:57:10.0399480"},"EventRecordID":"1213","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=f1108986-fd82-4ff6-993a-138269ea9765\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-22 13:57:10.0399480"},"EventRecordID":"1214","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\tNewProviderState=Started\tSequenceNumber=1\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=cb2a54ae-625a-4abf-9539-792c93cbe823\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-22 13:57:10.1348812"},"EventRecordID":"1215","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=f1108986-fd82-4ff6-993a-138269ea9765\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-22 13:57:10.1348812"},"EventRecordID":"1216","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=f1108986-fd82-4ff6-993a-138269ea9765\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-22 13:57:10.1569576"},"EventRecordID":"1217","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=f1108986-fd82-4ff6-993a-138269ea9765\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-22 13:57:10.1758269"},"EventRecordID":"1218","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=f1108986-fd82-4ff6-993a-138269ea9765\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-22 13:57:10.2067372"},"EventRecordID":"1219","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\tNewProviderState=Started\tSequenceNumber=11\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=f1108986-fd82-4ff6-993a-138269ea9765\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 25 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Applying safeguard.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-22 13:57:10.2067372"},"EventRecordID":"1220","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\tNewProviderState=Started\tSequenceNumber=3\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=cb2a54ae-625a-4abf-9539-792c93cbe823\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-22 13:57:10.2067372"},"EventRecordID":"1221","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\tNewProviderState=Started\tSequenceNumber=5\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=cb2a54ae-625a-4abf-9539-792c93cbe823\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-22 13:57:10.2164773"},"EventRecordID":"1222","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\tNewProviderState=Started\tSequenceNumber=7\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=cb2a54ae-625a-4abf-9539-792c93cbe823\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2025-04-22 13:57:10.2164773"},"EventRecordID":"1223","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\tNewProviderState=Started\tSequenceNumber=9\tHostName=ConsoleHost\tHostVersion=5.1.19041.5737\tHostId=cb2a54ae-625a-4abf-9539-792c93cbe823\tHostApplication=powershell.exe -ExecutionPolicy Restricted -Command$Res = 0 [UInt64]$MinDiskSpaceThreshold = 20 * 1024 * 1024 * 1024 try { $SystemDrive = (Get-CimInstance Win32_OperatingSystem).SystemDrive $SystemDriveLetter = $SystemDrive[0] $SystemDriveSpace = (Get-Volume -DriveLetter $SystemDriveLetter).SizeRemaining Write-Host 'Current system drive space:', $SystemDriveSpace.ToString('N0') if ($SystemDriveSpace -lt $MinDiskSpaceThreshold) { Write-Host 'System drive space is less than the threshold:', $MinDiskSpaceThreshold.ToString('N0'), 'Block Upgrade.' $Res = 1 } } catch { # Do nothing } Write-Host 'Final result:', $Res\tEngineVersion=\tRunspaceId=\tPipelineId=\tCommandName=\tCommandType=\tScriptName=\tCommandPath=\tCommandLine=","Binary":""}}}
